@model IEnumerable<D.Models.Сотрудник>
<div id="mdChart" class="modal" data-keyboard="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title">График результативности продавцов</h4>
            </div>
            <div class="modal-body">
                <div class="container-fluid">
                    <div class="row">
                        <div id="chart" class="col-xs-12 col-lg-12">


                        </div>
                    </div>

                </div>

            </div>

        </div>
    </div>
</div>
<script>
    $("ul.navbar-nav li:contains('Сотрудники')").addClass("active");

    $(function () {
        $('#datetimepicker1').datetimepicker({ pickTime: false, language: 'ru' });
    });

    $(document).on('click', '#tbEmployee tbody tr', function () {
        var ID = $(this).find("input[name='item.Табельный_номер']").val();
        var url = "@Url.Action("Details")/" + ID;
        document.location.href = url;
    });

    $(document).ready(function () {
        $('#tbEmployee').DataTable({
            buttons: [{
                fade: 500,
                autoClose: true,
                className: 'btn btn-xs',
                extend: 'collection',
                text: 'Экспорт',
                buttons: [{
                    extend: 'copy', text: 'Копировать', className: 'btn btn-xs', exportOptions: {
                        modifier: {
                            order: 'current',
                            page: 'current',
                            search: 'applied'
                        }
                    }
                }
            , {
                extend: 'excel', className: 'btn btn-xs', exportOptions: {
                    modifier: {
                        order: 'current',
                        page: 'current',
                        search: 'applied'
                    }
                }
            }, {
                extend: 'pdf', className: 'btn btn-xs', orientation: 'landscape', pageSize: 'A4', exportOptions: {
                    modifier: {
                        order: 'current',
                        page: 'current',
                        search: 'applied'
                    }
                }
            }, {
                extend: 'print', text: 'Печать', className: 'btn btn-xs', exportOptions: {
                    modifier: {
                        order: 'current',
                        page: 'current',
                        search: 'applied'
                    }
                }
            }
                ]
            }, { extend: 'colvis', text: 'Видимость столбцов', className: 'btn btn-xs' }],
            "preDrawCallback": function (settings) {

                $('#divForTable').fadeIn(1000);

            },
            "processing": true,
            stateSave: true,
            "stateDuration": 60 * 60 * 24,
            "order": [],
            fixedHeader: true,
            "autoWidth": false,
            "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "Все"]],
            "language": {
                "lengthMenu": "Показывать _MENU_ записей",
                "info": "Показаны записи с _START_ по _END_ из _TOTAL_",
                "infoFiltered": " (Найдено из _MAX_)",
                "emptyTable": "Нет данных для отображения",
                "infoEmpty": "Показаны записи с 0 по 0 из 0",
                "infoPostFix": "",
                "thousands": ",",
                "loadingRecords": "Загрузка...",
                "processing": "Обработка...",
                "search": "Поиск:",
                "zeroRecords": "Ничего не найдено",
                "paginate": {
                    "first": "Первая",
                    "last": "Последняя",
                    "next": "Следующая",
                    "previous": "Предыдущая"
                },
                buttons: {
                    copyTitle: 'Данные скопированы',
                    copyKeys: 'Используйте клавиатуру или меню для выбора команды',
                    copyTitle: 'Копирование в буфер',
                    copySuccess: {
                        1: "Скопирована одна запись в буфер",
                        _: "Скопировано %d записей в буфер"
                    },
                }
            },


            "dom": "<'row'<'col-sm-4'l><'col-sm-4'B><'col-sm-4'f>>" +
                    "<'row'<'col-sm-12'tr>>" +
                     "<'row'<'col-sm-5'i><'col-sm-7'p>>",
            "processing": true,

            fixedHeader: true
            //"pagingType": "full_numbers"
        });
    });
</script>
<div class="row">
    <div class="col-lg-2">@Html.Partial("_SideMenuEmployee")</div>
    <div class="col-lg-9 col-lg-offset-0">

        <table class="table-bordered table-striped table-hover table table-condensed" id="tbEmployee">
            <colgroup>
                <col width="9%">
                <col >
                <col width="10%">
                <col width="10%">
                <col width="35%">
                <col width="10%">
                <col <col width="10%">
            </colgroup>
            <thead>
                <tr>
                    <th class="text-center">
                        @Html.DisplayNameFor(model => model.Табельный_номер)
                    </th>
                    <th class="text-center">
                        @Html.DisplayNameFor(model => model.Фамилия)
                    </th>
                    <th class="text-center">
                        @Html.DisplayNameFor(model => model.Имя)
                    </th>
                    <th class="text-center">
                        @Html.DisplayNameFor(model => model.Отчество)
                    </th>
                    <th class="text-center">
                        @Html.DisplayNameFor(model => model.Должность)
                    </th>
                    <th class="text-center">
                        @Html.DisplayNameFor(model => model.Телефон)
                    </th>
                    <th class="text-center">
                        @Html.DisplayNameFor(model => model.Дата_рождения)
                    </th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
            {
                    <tr>
                        <td class="text-center">
                            @Html.DisplayFor(modelItem => item.Табельный_номер)
                            @Html.HiddenFor(modelItem=>item.Табельный_номер)
                        </td>
                        <td class="text-center">
                            @Html.DisplayFor(modelItem => item.Фамилия)
                        </td>
                        <td class="text-center">
                            @Html.DisplayFor(modelItem => item.Имя)
                        </td>
                        <td class="text-center">
                            @Html.DisplayFor(modelItem => item.Отчество)
                        </td>
                        <td class="text-center">
                            @Html.DisplayFor(modelItem => item.Должность)
                        </td>
                        <td class="text-center">
                            @Html.DisplayFor(modelItem => item.Телефон)
                        </td>
                        <td class="text-center">
                            @Html.DisplayFor(modelItem => item.Дата_рождения)
                        </td>
                    </tr>
                }
            </tbody>

        </table>
    </div>
    <div class="col-lg-1"></div>
</div>

<div id="mdNewEmployee" class="modal faden" data-keyboard="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title">Новый сотрудник</h4>
            </div>
            <div class="modal-body">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-xs-12 col-lg-12">
                            <fieldset>

                               @using (Html.BeginForm("Create","Сотрудник",FormMethod.Post))
                               {
                                @Html.AntiForgeryToken()

                                <div class="form-horizontal">

                                    
                                    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                                    <div class="form-group has-feedback">
                                        @Html.Label("Фамилия", htmlAttributes: new { @class = "control-label col-md-3" })
                                        <div class="col-md-7">
                                            @Html.Editor("Фамилия", new { htmlAttributes = new { @class = "form-control",  @pattern = "[^\\s0-9][A-Za-zА-Яа-яЁё\\s]{0,20}"  } })
                                            <span class="glyphicon form-control-feedback"></span>
                                        </div>
                                    </div>

                                    <div class="form-group has-feedback">
                                        @Html.Label("Имя", htmlAttributes: new { @class = "control-label col-md-3" })
                                        <div class="col-md-7">
                                            @Html.Editor("Имя", new { htmlAttributes = new { @class = "form-control", @pattern = "[^\\s0-9][A-Za-zА-Яа-яЁё\\s]{0,20}" } })
                                            <span class="glyphicon form-control-feedback"></span>
                                        </div>
                                    </div>

                                    <div class="form-group has-feedback">
                                        @Html.Label("Отчество", htmlAttributes: new { @class = "control-label col-md-3" })
                                        <div class="col-md-7">
                                            @Html.Editor("Отчество", new { htmlAttributes = new { @class = "form-control", @pattern = "[^\\s0-9][A-Za-zА-Яа-яЁё\\s]{0,20}" } })
                                            <span class="glyphicon form-control-feedback"></span>
                                        </div>
                                    </div>

                                    <div class="form-group has-feedback">
                                        @Html.Label("Должность", htmlAttributes: new { @class = "control-label col-md-3" })
                                        <div class="col-md-7">
                                            @Html.Editor("Должность", new { htmlAttributes = new { @class = "form-control", @pattern = "[^\\s0-9][A-Za-zА-Яа-яЁё\\s]{0,200}" } })
                                            <span class="glyphicon form-control-feedback"></span>
                                        </div>
                                    </div>

                                    <div class="form-group has-feedback">
                                        @Html.Label("Телефон", htmlAttributes: new { @class = "control-label col-md-3" })
                                        <div class="col-md-7">
                                            @Html.Editor("Телефон", new { htmlAttributes = new { @class = "form-control", @pattern = "[0-9\\+\\(\\)-]{4,20}" } })
                                            <span class="glyphicon form-control-feedback"></span>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        @Html.Label("Дата рождения", htmlAttributes: new { @class = "control-label col-md-3" })
                                        <div class="col-md-7 input-group date" id="datetimepicker1">
                                            <span class="input-group-addon">
                                                <span class="glyphicon-calendar glyphicon"></span>
                                            </span>
                                            <input type="text" id="Дата_рождения" name="Дата_рождения" class="form-control" required data-readonly />




                                        </div>
                                    </div>

                                    <div class="form-group has-feedback">
                                        @Html.Label("Номер паспорта", htmlAttributes: new { @class = "control-label col-md-3" })
                                        <div class="col-md-7">
                                            @Html.Editor("Номер_паспорта", new { htmlAttributes = new { @class = "form-control",@pattern = "[^\\s][A-Za-zА-Яа-яЁё0-9]{0,50}"  } })
                                            <span class="glyphicon form-control-feedback"></span>
                                        </div>
                                    </div>

                                    <div class="form-group has-feedback">
                                        @Html.Label("Адрес", htmlAttributes: new { @class = "control-label col-md-3" })
                                        <div class="col-md-7">
                                            @Html.Editor("Адрес", new { htmlAttributes = new { @class = "form-control", @pattern = "[A-Za-zА-Яа-яЁё\\s]{0,250}" } })
                                            <span class="glyphicon form-control-feedback"></span>
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-default" data-dismiss="modal">Закрыть</button>
                                        <button type="submit" class="btn btn-success">Добавить сотрудника</button>
                                    </div>
                                   
                                </div>
                               }
                            </fieldset>

                        </div>
                    </div>

                </div>

            </div>

        </div>
    </div>
</div>








@*<div class="dontPrint" id="chart">
</div>*@
<div class="scrollup">
    <i class="glyphicon glyphicon-chevron-up"></i>
</div>




@section scripts {
    <script type="text/javascript" src="/Scripts/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="/Scripts/bootstrap-datetimepicker.min.js"></script>
    <link rel="stylesheet" href="/Content/bootstrap-datetimepicker.min.css" />

}

<script type="text/javascript" src="~/Scripts/jsapi.js"></script>


<script type="text/javascript">
                 // Подгружаем API
            google.load('visualization', '1.0', { 'packages': ['corechart'] });

            // Устанавливаем callback
            google.setOnLoadCallback(drawChart);

            function drawChart() {

                var options = {
                    //'title': 'График результативности продавцов',
                    'width': 500,
                    'height': 400,
                    is3D: true,
                    //pieSliceText: 'label',
                    //backgroundColor: "#DADDE2",
                    chartArea: { left: 70, top: 40, width: '100%', height: '100%' },
                    pieSliceText: "percentage",
                    tooltip: { showColorCode: true, text: "value" },
                };

                var data = new google.visualization.DataTable();
                data.addColumn('string', 'Employees');
                data.addColumn('number', 'Orders');

                $.getJSON('@Url.Action("GetDataForChart", "Сотрудник")', null,
                                                                        function (result) {
                                                                            if (result.Employees.length) {
                                                                                $.each(result.Employees, function (index, c) {
                                                                                    data.addRow([c.Name, c.Value]);
                                                                                });
                                                                                // Отрисовка диаграммы
                                                                                var chart = new google.visualization.PieChart(
                                                                                document.getElementById('chart'));
                                                                                chart.draw(data, options);
                                                                            };
                                                                        });
            };
</script>