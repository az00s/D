@model D.Models.Order
@using D.Models
@{
    ViewBag.Title = "O заказe";
}
<script>
    $(document).ready(function () {

    $('.tbChoice').DataTable({

                                    "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "Все"]],

        "processing": true,
        "order": [[1,'desc']],
        fixedHeader: true,
        "autoWidth": false,
        "language": {
            "lengthMenu": "Показывать _MENU_ записей",
            "info": "Показаны записи с _START_ по _END_ из _TOTAL_ записей",
            "infoFiltered": " (Найдено из _MAX_ записей)",
            "emptyTable": "Нет данных для отображения",
            "infoEmpty": "Показаны записи с 0 по 0 из 0 записей",
            "infoPostFix":    "",
            "thousands":      ",",
            "loadingRecords": "Загрузка...",
            "processing":     "Обработка...",
            "search":         "Поиск:",
            "zeroRecords":    "Ничего не найдено",
            "paginate": {
                "first":      "Первая",
                "last":       "Последняя",
                "next":       "Следующая",
                "previous":   "Предыдущая"
            }
        },

        "dom": "<'row'<'col-sm-6'l><'col-sm-6'f>>" +
                "<'row'<'col-sm-12'tr>>" +
                 "<'row'<'col-sm-0'><'col-sm-12'p>>",
        "columnDefs": [
    { "width": "25%", "targets": 0 },
    { "width": "25%", "targets": 1 }
        ],
        fixedHeader: true,
        "paging": true
    });


    $('#tbGoodsChosen').DataTable({

        "processing": true,


        "order": [],
        fixedHeader: true,
        "autoWidth": false,

        "language": {

            "info": "Показаны записи с _START_ по _END_ из _TOTAL_",

            "emptyTable": "Нет данных для отображения",
            "infoEmpty": "Показаны записи с 0 по 0 из 0",
            "infoPostFix": "",
            "thousands": ",",
            "loadingRecords": "Загрузка...",
            "processing": "Обработка...",
            "search": "Поиск:",
            "zeroRecords": "Ничего не найдено",


        },


        "dom":
                "<'row'<'col-sm-12'tr>>",


        fixedHeader: true
    });

    
    });


</script>
<div class="container">
    <div class="well bs-component">
        <div class="row">
            <div class="col-xs-12 col-lg-8">

                <fieldset>
                    <legend>
                        <ul class="nav">
                            <li class="">
                                <a data-toggle="dropdown" class="dropdown-toggle" style="color:black;">Информация о заказе  <span class="caret"></span></a>
                                <ul class="dropdown-menu">
                                    <li><a href="#EditModal" data-toggle="modal"> Редактировать</a> </li>
                                    <li><a href="#DeleteModal" data-toggle="modal">Удалить</a></li>
                                </ul>
                            </li>
                        </ul>
                    </legend>


                    <div>

                        <dl class="dl-horizontal">


                            <dt>
                                @Html.DisplayNameFor(model => model.OrderID)

                            </dt>
                            <dd>
                                @Html.DisplayFor(model => model.OrderID)

                            </dd>
                            <dt>
                                @Html.DisplayNameFor(model => model.OrderDate)
                            </dt>

                            <dd>
                                @Html.DisplayFor(model => model.OrderDate)
                            </dd>

                            <dt>
                                Клиент
                            </dt>

                            <dd>
                                @{string CustomerName, Property, ID; if (Model.CustomerEnt != null)
                                    {
                                        CustomerName = Model.CustomerEnt.Name;
                                        Property = "ClientID";
                                        ID = Model.CustomerEnt.ClientID.ToString();
                                    }
                                    else

                                    {
                                        CustomerName = Model.CustomerInd.LastName + " " + Model.CustomerInd.FirstName;
                                        Property = "CustomerIndId";
                                        ID = Model.CustomerInd.CustomerIndId.ToString();
                                    }

                                    }
                                @CustomerName
                            </dd>

                            <dt>
                                Сотрудник
                            </dt>

                            <dd>
                                @Html.DisplayFor(model => model.Employee.LastName)
                            </dd>



                        </dl>
                    </div>
                    <table class="table-bordered table-striped" >
                        <colgroup>
                            <col width="25%"/>
                            <col  />
                            <col width="10%" />
                            <col width="10%" />
                            <col width="10%" />
                            <col width="10%" />
                        </colgroup>
                        <thead>
                            
                                <tr>
                                    <th class="text-center">Обозначение</th>
                                    <th class="text-center">Наименование</th>
                                    <th class="text-center">Ед.изм.</th>
                                    <th class="text-center">Количество</th>
                                    <th class="text-center">Цена</th>
                                    <th class="text-center">Цена с НДС</th>

                                </tr>
                            
                        </thead>
                        <tbody>
                            @foreach (Ordering p in (ViewBag.OfList as IQueryable<Ordering>))
                            {
                                <tr>
                                    <td class="text-center">
                                        <strong> @p.Product.Designation</strong>
                                    </td>
                                    <td class="text-center">
                                        <strong>@p.Product.Name</strong>
                                    </td>
                                    <td class="text-center">
                                        <strong>@p.Product.Unit_of_measurement</strong>
                                    </td>
                                    <td class="text-center">
                                        <strong>@p.ProductQuantity.ToString()</strong>
                                    </td>
                                    <td class="text-center">
                                        <strong>@p.Product.Price.Value.ToString("0.00")</strong>
                                    </td>
                                    <td class="text-center">
                                        <strong>@p.Product.Price_with_vat.Value.ToString("0.00")</strong>
                                    </td>

                                </tr>


                            }
                            <tr><td colspan="4"></td><td class="text-center" ><strong>Итого:</strong></td><td class="text-center"><strong>@ViewBag.Amount</strong></td></tr>

                        </tbody>
                    </table>
                    

                </fieldset>
            </div>
            <div class="col-xs-12 col-lg-4">

                <table class="table-bordered table-striped" id="LinkedProvider">
                    <col width="15%"/>
                    <col width="20%"/>
                    <col >
                    <col width="15%"/>
                    <col width="10%" />
                    <thead>
                        <tr><th class="text-center" colspan="4" style="border:none;">Связанные поступления</th></tr>

                        <tr>
                            <th class="text-center">Номер</th>
                            <th class="text-center">Дата</th>
                            <th class="text-center">Клиент</th>
                            <th class="text-center">Сумма</th>
                            @{ if ((ViewBag.Paylist as IQueryable<OrderPayment>).Count() > 0)
                                {
                                    <th></th>
                                }
                            }
                        </tr>


                    </thead>
                    <tbody>
                        @foreach (OrderPayment p in (ViewBag.Paylist as IQueryable<OrderPayment>))
                        {
                            <tr>
                                <td class="text-center">@p.ReceiptID.ToString()</td>
                                <td class="text-center">@p.MoneyReceipt.ReceiptDate.Value.ToString("dd.MM.yyyy")</td>
                                
                                <td class="text-center">@p.MoneyReceipt.CustomerEnt.Name</td>
                                <td class="text-center">@p.Amount.Value.ToString("0.00")</td>
                                <td class="text-center">
                                    @using (Html.BeginForm("DeleteP", "Order", p, FormMethod.Post))
                                    {
                                        <input type="image" src="~/Content/png/error.png" />
                                    }
                                </td>

                            </tr>
                        }
                    </tbody>
                </table>

               

                    
               

            </div>
        </div>
    </div>



</div>
<div id="DeleteModal" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title">Вы действительно хотите удалить этот заказ?</h4>
            </div>
            <div class="modal-body">


                <dl class="dl-horizontal">


                    <dt>
                        @Html.DisplayNameFor(model => model.OrderID)

                    </dt>
                    <dd>
                        @Html.DisplayFor(model => model.OrderID)

                    </dd>
                    <dt>
                        @Html.DisplayNameFor(model => model.OrderDate)
                    </dt>

                    <dd>
                        @Html.DisplayFor(model => model.OrderDate)
                    </dd>

                    <dt>
                        Клиент
                    </dt>

                    <dd>
                        @CustomerName
                    </dd>

                    <dt>
                        Сотрудник
                    </dt>

                    <dd>
                        @Html.DisplayFor(model => model.Employee.LastName)
                    </dd>



                </dl>
            </div>




            <div class="modal-footer">
                @using (Html.BeginForm("Delete", "Order", new { id = Model.OrderID }, FormMethod.Post))
            {
                    @Html.AntiForgeryToken()
                    <button type="button" class="btn btn-default" data-dismiss="modal">Закрыть</button>

                    <button type="submit" class="btn btn-danger">Удалить</button>

                }
            </div>
        </div>



    </div>
</div>

<div id="EditModal" class="modal fade">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title">Редактирование заказа</h4>
            </div>
            <div class="modal-body">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-xs-12 col-lg-12">
                            <fieldset>
                                @using (Html.BeginForm("Edit", "Order", FormMethod.Post,new { @id="fmEditOrder"}))
                                {
                                    @Html.AntiForgeryToken()

                                    <div class="form-horizontal">

                                        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                                        @Html.HiddenFor(model => model.OrderID)



                                        <div class="form-group">
                                            @Html.Label("Дата заказа", htmlAttributes: new { @class = "control-label col-md-3" })
                                            <div class="col-md-7 input-group date" id="datetimepicker1">
                                                <span class="input-group-addon">
                                                    <span class="glyphicon-calendar glyphicon"></span>
                                                </span>
                                                @Html.TextBox("OrderDate", Model.OrderDate.Value.ToString("dd.MM.yyyy"), new { @class = "form-control", @readonly = "readonly", @required = "required" })

                                            </div>
                                        </div>
                                        <script type="text/javascript">
                                            $(function () {
                                                $('#datetimepicker1').datetimepicker({ pickTime: false, language: 'ru' });
                            });
                                        </script>
                                        
                                        <div class="form-group">
                                            <label class="control-label col-md-3">Клиент</label>
                                            <div class="col-md-7">
                                                <div class="indoorBtnDiv input-group">
                                                    <input type="hidden" id="iptCustomerHidden" value="@ID" name="@Property" />
                                                    <input id="indoorText" class="form-control" name="Клиент" type="text" value="@CustomerName" readonly required />
                                                    <div class="input-group-btn">
                                                        <a href="#mdChoiceClient" class="indoorBtn btn btn-default" data-toggle="modal">+</a>
                                                    </div>
                                                </div>

                                            </div>
                                        </div>
                                        <script>
                                            $(document).ready(function () {
                                                $('#LinkedProvider').DataTable({
                                                    "ordering": false,
                                                    "processing": true,
                                                 
                                                    fixedHeader: true,
                                                    "autoWidth": false,
                                                    "language": {
                                                        "lengthMenu": "Показывать _MENU_ записей",
                                                        "info": "Показаны записи с _START_ по _END_ из _TOTAL_ записей",
                                                        "infoFiltered": " (Найдено из _MAX_ записей)",
                                                        "emptyTable": "Нет данных для отображения",
                                                        "infoEmpty": "Показаны записи с 0 по 0 из 0 записей",
                                                        "infoPostFix":    "",
                                                        "thousands":      ",",
                                                        "loadingRecords": "Загрузка...",
                                                        "processing":     "Обработка...",
                                                        "search":         "Поиск:",
                                                        "zeroRecords":    "Ничего не найдено",
                                                        "paginate": {
                                                            "first":      "Первая",
                                                            "last":       "Последняя",
                                                            "next":       "Следующая",
                                                            "previous":   "Предыдущая"
                                                        }
                                                    },

                                                    "dom": "t",
                                                    
                                                    fixedHeader: true
                                                    //"pagingType": "full_numbers"
                                                });



                                            

                                                
                                            
                                                
                                            




                                            });
                                             $(document).on('click', '.modal-content button[data-dismiss="modal"]', (function () {


                                                $('table tr').removeClass('chosen');
                                                $(".clear button[type='submit']").attr("disabled", "disabled");
                            }));


                                        </script>
                                        
                                        <div class="form-group">
                                            <label class="control-label col-md-3">Сотрудник</label>
                                            <div class="col-md-7">
                                                <div class="indoorBtnDiv input-group">
                                                    <input type="hidden" value="@Model.PersonnelNumber" name="PersonnelNumber" />
                                                    <input id="indoorTextEmployee" class="form-control" name="Emp" type="text" value="@Model.Employee.LastName" readonly required />
                                                    <div class="input-group-btn">
                                                        <a href="#mdEmployeeChoice" class="indoorBtn btn btn-default" data-toggle="modal">+</a>
                                                    </div>
                                                </div>

                                            </div>
                                        </div>
                                        <script>

                                            $(document).on('click', '#btEmployeeChoice', (function () {

                                                var id = $('.chosen input[type=hidden]').attr("value");

                                                var name = $("#tbEmployeeChoice .chosen strong")[0].innerText;

                                                $("#indoorTextEmployee").val(name);
                                                $("#EditModal input[name='PersonnelNumber']").val(id);
                                                $('#tbEmployeeChoice tr').removeClass('chosen');
                                                $("#btEmployeeChoice").attr("disabled", "disabled");


                                            }));


                                            $(document).on('click', '#tbEmployeeChoice tbody tr', function () {

                                                if ($(this).is('.chosen')) {
                                                    $(this).removeClass('chosen');
                                                    $("#btEmployeeChoice").attr('disabled', 'disabled');
                                                }
                                                else {
                                                    $("#tbEmployeeChoice tr").removeClass('chosen');

                                                    $(this).toggleClass('chosen');


                                                    if ($("#tbEmployeeChoice tr.chosen")) {
                                                        $("#btEmployeeChoice").removeAttr("disabled");
                                                    }

                                                    if (!($("tr").is(".chosen"))) {
                                                        $("#btEmployeeChoice").attr("disabled", "disabled");
                                                    }
                                                }

                                            });


                                            $('#tbEmployeeChoice').DataTable({

                                "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "Все"]],

                                                "processing": true,
                                                //"order": [[1, 'desc']],
                                                fixedHeader: true,
                                                "autoWidth": false,
                                                "language": {
                                                    "lengthMenu": "Показывать _MENU_ записей",
                                                    "info": "Показаны записи с _START_ по _END_ из _TOTAL_ записей",
                                                    "infoFiltered": " (Найдено из _MAX_ записей)",
                                                    "emptyTable": "Нет данных для отображения",
                                                    "infoEmpty": "Показаны записи с 0 по 0 из 0 записей",
                                                    "infoPostFix": "",
                                                    "thousands": ",",
                                                    "loadingRecords": "Загрузка...",
                                                    "processing": "Обработка...",
                                                    "search": "Поиск:",
                                                    "zeroRecords": "Ничего не найдено",
                                                    "paginate": {
                                                        "first": "Первая",
                                                        "last": "Последняя",
                                                        "next": "Следующая",
                                                        "previous": "Предыдущая"
                                                    }
                                                },

                                                "dom": "<'row'<'col-sm-6'l><'col-sm-6'f>>" +
                                                        "<'row'<'col-sm-12'tr>>" +
                                                         "<'row'<'col-sm-0'><'col-sm-12'p>>",
                                                "columnDefs": [
                                            { "width": "25%", "targets": 0 },
                                            { "width": "25%", "targets": 1 }
                                                ],
                                                fixedHeader: true,
                                                "paging": true
                                            });
                                        </script>
                                        <div class="form-group">

                                            <div class="col-md-7 col-md-offset-3">
                                                <div class="input-group">

                                                    <div class="input-group-btn">
                                                        <a href="#mdGoodsChoice" class="btn btn-default" data-toggle="modal">Добавить товар в заказ</a>
                                                    </div>
                                                </div>

                                            </div>
                                        </div>
                                        <table class="table-bordered table-striped" id="tbGoodsChosen">
                                            <colgroup>
                                                <col width="25%">
                                                <col width="25%">
                                            </colgroup>
                                            <thead>

                                                <tr>
                                                    <th class="text-center">Обозначение</th>
                                                    <th class="text-center">Наименование</th>
                                                    <th class="text-center">Ед.изм.</th>

                                                    <th class="text-center">Цена</th>
                                                    <th class="text-center">Цена с НДС</th>
                                                    <th class="text-center">Количество</th>
                                                    <th class="text-center"></th>

                                                </tr>

                                            </thead>
                                            <tbody>
                                                @{ foreach (var o in (ViewBag.OfList as IQueryable<Ordering>))
                                                    { <tr>
                                                        <td class="text-center">@Html.Hidden("OrderID", o.OrderID) @Html.Hidden("ProductID", o.ProductID) @o.Product.Designation</td>
                                                        <td class="text-center">@o.Product.Name</td>
                                                          <td class="text-center">@o.Product.Unit_of_measurement</td>
                                                          <td class="text-center">@o.Product.Price</td>
                                                          <td class="text-center">@o.Product.Price_with_vat</td>
                                                          <td class="text-center"><input type="number" min="1" max="2147483647" name="ProductQuantity" style="width:70px;" value="@o.ProductQuantity" required /></td>
                                                          <td class="text-center"><a class="glyphicon glyphicon-remove" style="text-decoration:none;color:#E81C2C"></a></td>
                                                </tr>}
                                                }
                                            </tbody>

                                        </table>
                                       

                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-default" data-dismiss="modal">Закрыть</button>
                                            <button type="submit" class="btn btn-success" id="btGoodsChosen">Сохранить</button>
                                        </div>
                                    </div>
                                }
                                <script>

                                    $('#fmEditOrder').submit(function () {
                                var rows = $("#tbGoodsChosen tbody tr");
                                for (var i = 0; i < rows.length; i++)
                                {
                                    $("input[name='OrderID']", rows[i]).attr('name', '[' + i + '].OrderID').val(@Model.OrderID);
                                    $("input[name='ProductID']", rows[i]).attr('name', '[' + i + '].ProductID');
                                    $("input[name='ProductQuantity']", rows[i]).attr('name', '[' + i + '].ProductQuantity');
                            }

                                    return true;
                                });
                                </script>
                            </fieldset>
                        </div>
                        

                    </div>

                </div>
            </div>
        </div>
    </div>
</div>
<script>
                                    $(document).ready(function () {

                                        $('#tbCustomerEnts').DataTable({

                                            "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "Все"]],

                                            "processing": true,
                                            "order": [[1, 'desc']],
                                            fixedHeader: true,
                                            "autoWidth": false,
                                            "language": {
                                                "lengthMenu": "Показывать _MENU_ записей",
                                                "info": "Показаны записи с _START_ по _END_ из _TOTAL_ записей",
                                                "infoFiltered": " (Найдено из _MAX_ записей)",
                                                "emptyTable": "Нет данных для отображения",
                                                "infoEmpty": "Показаны записи с 0 по 0 из 0 записей",
                                                "infoPostFix": "",
                                                "thousands": ",",
                                                "loadingRecords": "Загрузка...",
                                                "processing": "Обработка...",
                                                "search": "Поиск:",
                                                "zeroRecords": "Ничего не найдено",
                                                "paginate": {
                                                    "first": "Первая",
                                                    "last": "Последняя",
                                                    "next": "Следующая",
                                                    "previous": "Предыдущая"
                                                }
                                            },

                                            "dom": "<'row'<'col-sm-6'l><'col-sm-6'f>>" +
                                                    "<'row'<'col-sm-12'tr>>" +
                                                     "<'row'<'col-sm-0'><'col-sm-12'p>>",
                                            "columnDefs": [
                                        { "width": "25%", "targets": 0 },
                                        { "width": "25%", "targets": 1 }
                                            ],
                                            fixedHeader: true,
                                            "paging": true
                                        });

                                        $('#tbCustomerInds').DataTable({

                                            "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "Все"]],

                                            "processing": true,
                                            "order": [[1, 'desc']],
                                            fixedHeader: true,
                                            "autoWidth": false,
                                            "language": {
                                                "lengthMenu": "Показывать _MENU_ записей",
                                                "info": "Показаны записи с _START_ по _END_ из _TOTAL_ записей",
                                                "infoFiltered": " (Найдено из _MAX_ записей)",
                                                "emptyTable": "Нет данных для отображения",
                                                "infoEmpty": "Показаны записи с 0 по 0 из 0 записей",
                                                "infoPostFix": "",
                                                "thousands": ",",
                                                "loadingRecords": "Загрузка...",
                                                "processing": "Обработка...",
                                                "search": "Поиск:",
                                                "zeroRecords": "Ничего не найдено",
                                                "paginate": {
                                                    "first": "Первая",
                                                    "last": "Последняя",
                                                    "next": "Следующая",
                                                    "previous": "Предыдущая"
                                                }
                                            },

                                            "dom": "<'row'<'col-sm-6'l><'col-sm-6'f>>" +
                                                    "<'row'<'col-sm-12'tr>>" +
                                                     "<'row'<'col-sm-0'><'col-sm-12'p>>",
                                            "columnDefs": [
                                        { "width": "25%", "targets": 0 },
                                        { "width": "25%", "targets": 1 }
                                            ],
                                            fixedHeader: true,
                                            "paging": true
                                        });




                                    });


                                    $(document).on('click', '.modal-content button[data-dismiss="modal"]', (function () {


                                        $('table tr').removeClass('chosen');
                                        $(".clear button[type='submit']").attr("disabled", "disabled");
                                    }));

                                    $(document).on('click', '#btChoiceClient', (function () {

                                        var id = $('.chosen input[type=hidden]').attr("value");
                                       
                                        if ($(".chosen").parent().parent().attr("id") == "tbCustomerEnts") {

                                            var name = $(".table-striped .chosen strong")[1].innerText;
                                            $("#iptCustomerHidden").attr("name", "ClientID");
                                            $("#iptCustomerHidden").val(id);


                                        }
                                        else {

                                            var name = $(".table-striped .chosen strong")[0].innerText + " " + $(".table-striped .chosen strong")[1].innerText;
                                            $("#iptCustomerHidden").attr("name", "CustomerIndId");
                                            $("#iptCustomerHidden").val(id);

                                        }
                                        $("#indoorText").val(name);

                                        $('.table-striped tr').removeClass('chosen');
                                        $("#btChoiceClient").attr("disabled", "disabled");


                                    }));



                                    $(document).ready(function () {
                                        $(document).on('click', '#tbCustomerInds tbody tr', function choice(tableId, buttonId) {

                                            if ($(this).is('.chosen')) {
                                                $(this).removeClass('chosen');
                                                $("#btChoiceClient").attr('disabled', 'disabled');
                                            }
                                            else {
                                                $("#tbCustomerInds tr").removeClass('chosen');

                                                $(this).toggleClass('chosen');


                                                if ($("#tbCustomerInds tr.chosen")) {
                                                    $("#btChoiceClient").removeAttr("disabled");
                                                }

                                                if (!($("tr").is(".chosen"))) {
                                                    $("#btChoiceClient").attr("disabled", "disabled");
                                                }
                                            }

                                        });

                                        $(document).on('click', '#tbCustomerEnts tbody tr', function choice(tableId, buttonId) {

                                            if ($(this).is('.chosen')) {
                                                $(this).removeClass('chosen');
                                                $("#btChoiceClient").attr('disabled', 'disabled');
                                            }
                                            else {
                                                $("#tbCustomerEnts tr").removeClass('chosen');

                                                $(this).toggleClass('chosen');


                                                if ($("#tbCustomerEnts tr.chosen")) {
                                                    $("#btChoiceClient").removeAttr("disabled");
                                                }

                                                if (!($("tr").is(".chosen"))) {
                                                    $("#btChoiceClient").attr("disabled", "disabled");
                                                }
                                            }

                                        });

                                        $("#btChoiceCustomer").click(function () {


                                            $("#dvCustomerLink").css("display", "block");
                                            $("#dvCustomerEnts").css("display", "none");
                                            $("#dvCustomerInds").css("display", "none");
                                        });


                                    });

</script>

<div id="mdChoiceClient" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title">Выберите клиента</h4>
            </div>
            <div class="modal-body">
                <div id="dvCustomerLink"><a id="lkCustomerEnts" href=#>Юридические лица</a>     <a id="lkCustomerInds" href=#>Физические лица</a></div>
                <script>
                    $(document).ready(function () {

                        $("#lkCustomerEnts").click(function () {
                            $("#dvCustomerLink").css("display", "none");
                            $("#dvCustomerEnts").css("display", "block");
                        });

                        $("#lkCustomerInds").click(function () {
                            $("#dvCustomerLink").css("display", "none");
                            $("#dvCustomerInds").css("display", "block");
                        })
                    })
                </script>
                <div id="dvCustomerEnts">
                    @Html.Action("AllCustomerEnts")
                </div>
                <div id="dvCustomerInds">
                    @Html.Action("AllCustomerInds")
                </div>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Закрыть</button>
                <button type="button" class="btn btn-primary" id="btChoiceClient" disabled>Выбрать</button>
            </div>
        </div>
    </div>
</div>
<div id="mdEmployeeChoice" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title">Выберите сотрудника</h4>
            </div>
            <div class="modal-body">
                <table class="table-bordered table-striped tbChoice" id="tbEmployeeChoice">
                    <colgroup>
                        <col width="25%">
                        <col width="20%">
                        <col width="25%">
                        <col width="25%">
                    </colgroup>

                    <thead>
                        <tr>
                            <th class="text-center">Фамилия</th>
                            <th class="text-center">Имя</th>
                            <th class="text-center">Отчество</th>
                            <th class="text-center">Должность</th>
                        </tr>

                    </thead>
                    <tbody>
                        @Html.Action("AllEmployee")
                    </tbody>
                </table>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Закрыть</button>
                <button type="button" class="btn btn-primary" id="btEmployeeChoice" disabled>Выбрать</button>
            </div>
        </div>
    </div>
</div>
<div class="scrollup">
    <i class="glyphicon glyphicon-chevron-up"></i>
</div>

@section scripts {
    <script type="text/javascript" src="/Scripts/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="/Scripts/bootstrap-datetimepicker.min.js"></script>
    <link rel="stylesheet" href="/Content/bootstrap-datetimepicker.min.css" />

}




<div id="mdGoodsChoice" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title">Выберите товар</h4>
            </div>
            <div class="modal-body" id="dvGoodsChoice">

                @Html.Action("AllGoods")

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Закрыть</button>
                <button type="button" class="btn btn-primary" id="btChoiceGoods" disabled>Выбрать</button>
            </div>
        </div>
    </div>
</div>

<script>

    $(document).on('click', '#tbGoodsChoice tbody tr', (function () {

                                if ($(this).is('.chosen')) {
            $(this).removeClass('chosen');
                                    //$("#btChoiceGoods").attr('disabled', 'disabled');
                                }
        else {
            //$('#tbGoodsChoice tr').removeClass('chosen');

            $(this).toggleClass('chosen');


                                    if ($('#tbGoodsChoice tr .chosen')) {
                $("#btChoiceGoods").removeAttr("disabled");
                                    }

                                    if (!($("tr").is(".chosen"))) {
                $("#btChoiceGoods").attr("disabled", "disabled");
                                    }
                                }
                                if (!($("tr").is(".chosen"))) {
            $("#btChoiceGoods").attr("disabled", "disabled");
                                }
        else { $("#btChoiceGoods").removeAttr("disabled"); }
                            }));

    $(document).on('click', '.modal-content button[data-dismiss="modal"]', (function () {


        $('#tbGoodsChoice tr').removeClass('chosen');
        $("#btChoiceGoods").attr("disabled", "disabled");
                            }));

    //$(document).on('click', '#btChoiceGoods', (function () {
    //    var a = $('.chosen input[type=hidden]').attr("value");
    //    $("#indoorText").val(a);
    //    $('#tbProviders tr').removeClass('chosen');
    //    $("#btChoiceProv").attr("disabled", "disabled");


    //}));

    $('#btChoiceGoods').click(function () {


                                var tr = $('#tbGoodsChoice tr.chosen');
                                var table= $('#tbGoodsChoice').DataTable();

                                var rows = table
                                    .rows('.chosen')
                                    .remove()
                                    .draw();
                                var tableGoodsChosen = $("#tbGoodsChosen").DataTable();
                                var tr1 = tr.append('<td class="text-center"><input type="number" min="1" max="2147483647" name="ProductQuantity" style="width:70px;" value="1" required /></td><td class="text-center"><a class="glyphicon glyphicon-remove" style="text-decoration:none;color:#E81C2C"></a></td>');
                                tableGoodsChosen.rows.add(tr1).draw();
        //$('#tbGoodsChosen > tbody:last-child').append(tr);
        $('#tbGoodsChosen tr.chosen').removeClass('chosen').removeClass('odd').removeAttr("role").addClass('added');
        //$('#tbGoodsChosen tbody tr.added').append('<td class="text-center"><input type="number" min="1" max="2147483647" name="Количество" style="width:70px;" value="1" required /></td><td class="text-center"><a class="glyphicon glyphicon-remove" style="text-decoration:none;color:#E81C2C"></a></td>');
        $('#tbGoodsChosen tbody tr.added').removeClass('added');
        $('#tbGoodsChosen tr').unbind('click');

        @*$.ajax({method: "GET",url: "@Url.Action("AllGoods")"}).done( function (data) {
            $('#dvGoodsChoice').html(data);
        });*@
    });

    $("#EditModal button.clear").click(function () {
        $("#EditModal input[type='text']").val(null);



        $('#tbGoodsChosen').DataTable()
            clear()
            .draw();
    });

    $(document).on("click", ".glyphicon-remove", function () {
        $('#tbGoodsChosen').DataTable()
            .row($(this).closest("tr"))
            .remove()
            .draw();
    });
</script>